<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
      integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
      crossorigin="anonymous"
    />
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>

    <title>Survey</title>
  </head>
  <body>
    <div class="container">
      <h1>Survey Questions</h1>
      <hr />
      <h2>About You</h2>
      <form class="needs-validation" novalidate>
        <div class="class form-group">
          <label for="inputName">Name (Required)</label>
          <input
            type="text"
            class="form-control"
            id="inputName"
            placeholder=""
            required
          />
        </div>
        <div class="class form-group">
          <label for="inputPicture">Link to Photo (Required)</label>
          <input
            type="text"
            class="form-control"
            id="inputPicture"
            placeholder=""
            required
          />
        </div>
        <hr />
        <h2>Question 1</h2>
        <div class="form-group">
          <label for="question1">A hotdog is a sandwich.</label>
          <select class="form-control" id="question1" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 2</h2>
        <div class="form-group">
          <label for="question2">Puns are hilarious.</label>
          <select class="form-control" id="question2" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 3</h2>
        <div class="form-group">
          <label for="question3">Fall is the best season.</label>
          <select class="form-control" id="question3" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 4</h2>
        <div class="form-group">
          <label for="question4"
            >Alcohol is the cause of all my problems.</label
          >
          <select class="form-control" id="question4" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 5</h2>
        <div class="form-group">
          <label for="question5">The Princess Bride deserved an Oscar.</label>
          <select class="form-control" id="question5" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 6</h2>
        <div class="form-group">
          <label for="question6"
            >Toilet paper should be hung with the loose end draped over the
            top.</label
          >
          <select class="form-control" id="question6" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 7</h2>
        <div class="form-group">
          <label for="question7">The goat is the rudest animal.</label>
          <select class="form-control" id="question7" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 8</h2>
        <div class="form-group">
          <label for="question8">Socks go on before your pants.</label>
          <select class="form-control" id="question8" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 9</h2>
        <div class="form-group">
          <label for="question9">Never judge a film by its trailer.</label>
          <select class="form-control" id="question9" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <h2>Question 10</h2>
        <div class="form-group">
          <label for="question10"
            >The Harry Potter movies are just as good as the books.</label
          >
          <select class="form-control" id="question10" required>
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <button
          type="submit"
          id="submit-btn"
          class="btn btn-success btn-lg btn-block"
        >
          <span class="fas fa-check-double"></span> Submit
        </button>
      </form>
      <hr />

      <footer class="footer">
        <div class="container">
          <p>
            <a href="/api/friends">API Friends Link</a> |
            <a href="https://github.com/andersac88/Friend_Finder"
              >GitHub Repo</a
            >
          </p>
        </div>
      </footer>
    </div>

    <!-- Modal -->
    <div
      class="modal fade"
      id="myModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Incomplete:</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Please complete all the fields and resubmit.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" data-dismiss="modal">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

<!-- Modal Success -->
<div
class="modal fade"
id="successModal"
tabindex="-1"
role="dialog"
aria-labelledby="exampleModalLabel"
aria-hidden="true"
>
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Your New Best Friend:</h5>
      <button
        type="button"
        class="close"
        data-dismiss="modal"
        aria-label="Close"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <h1 class="name"></h1>
      <img class="picture">
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-success" data-dismiss="modal">
        Close
      </button>
    </div>
  </div>
</div>
</div>

    <script>
      // Example starter JavaScript for disabling form submissions if there are invalid fields
      (function() {
        "use strict";
        window.addEventListener(
          "load",
          function() {
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName("needs-validation");
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function(form) {
              form.addEventListener(
                "submit",
                function(event) {
                  if (form.checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                    $("#myModal").modal("show");
                  } 
                  else {
                    event.preventDefault();
                    let newUser = {
                      name: $("#inputName")
                        .val()
                        .trim(),
                      photo: $("#inputPicture").val(),
                      scores: [
                        $("#question1").val(),
                        $("#question2").val(),
                        $("#question3").val(),
                        $("#question4").val(),
                        $("#question5").val(),
                        $("#question6").val(),
                        $("#question7").val(),
                        $("#question8").val(),
                        $("#question9").val(),
                        $("#question10").val()
                      ]
                    };
                    $.post("/api/friends", newUser, data => {
                      $(".name").text(data.name);
                      $(".picture").attr("src", data.photo);
                      $("#successModal").modal("show");
                      $("#inputName").val("");
                      $("#inputPicture").val("");
                      $("#question1").val("");
                      $("#question2").val("");
                      $("#question3").val("");
                      $("#question4").val("");
                      $("#question5").val("");
                      $("#question6").val("");
                      $("#question7").val("");
                      $("#question8").val("");
                      $("#question9").val("");
                      $("#question10").val("");
                    });
                  }
                  form.classList.add("was-validated");
                },
                false
              );
            });
          },
          false
        );
      })();
    </script>
  </body>
</html>
